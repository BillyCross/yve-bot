!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("YveBot",[],e):"object"==typeof exports?exports.YveBot=e():t.YveBot=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=41)}([function(t,e,n){"use strict";function r(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}e.a=r},function(t,e,n){"use strict";var r=n(24),o="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||o||Function("return this")();e.a=i},function(t,e,n){"use strict";function r(t){return null!=t&&"object"==typeof t}e.a=r},function(t,e,n){"use strict";var r=Array.isArray;e.a=r},function(t,e,n){"use strict";function r(t){return null==t?void 0===t?u:s:c&&c in Object(t)?Object(i.a)(t):Object(a.a)(t)}var o=n(15),i=n(48),a=n(49),s="[object Null]",u="[object Undefined]",c=o.a?o.a.toStringTag:void 0;e.a=r},function(t,e,n){"use strict";var r=n(6),o=Object(r.a)(Object,"create");e.a=o},function(t,e,n){"use strict";function r(t,e){var n=Object(i.a)(t,e);return Object(o.a)(n)?n:void 0}var o=n(56),i=n(60);e.a=r},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var o=n(65),i=n(66),a=n(67),s=n(68),u=n(69);r.prototype.clear=o.a,r.prototype.delete=i.a,r.prototype.get=a.a,r.prototype.has=s.a,r.prototype.set=u.a,e.a=r},function(t,e,n){"use strict";function r(t,e){for(var n=t.length;n--;)if(Object(o.a)(t[n][0],e))return n;return-1}var o=n(9);e.a=r},function(t,e,n){"use strict";function r(t,e){return t===e||t!==t&&e!==e}e.a=r},function(t,e,n){"use strict";function r(t,e){var n=t.__data__;return Object(o.a)(e)?n["string"==typeof e?"string":"hash"]:n.map}var o=n(71);e.a=r},function(t,e,n){"use strict";function r(t,e){this.key="validator",this.message=t||'Invalid value for "'+e.type+'" type'}function o(t,e){this.key="invalidAttribute",this.message="Invalid "+t+' attribute "'+e.type+'"'}function i(t,e){this.key="ruleNotFound",this.message='Rule "'+t+'" not found in indexes',this.indexes=e}function a(t){this.key="pauseRuleTypeExecutors",this.message='Rule "'+t+'" must pause execution'}Object.defineProperty(e,"__esModule",{value:!0}),e.ValidatorError=r,e.InvalidAttributeError=o,e.RuleNotFound=i,e.PauseRuleTypeExecutors=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(28),o=function(){function t(){}return t.prototype.define=function(t,e,n){var r=this,o=!(n&&n.override);if("string"!=typeof t)Object.keys(t).forEach(function(n){r.define(n,t[n],e)});else if(o&&t in this){var i=typeof this;console.warn("You can't redefine \""+t+'" in '+i+". You can force it using { override: true } in options argument.")}else this[t]=e;return this},t.prototype.extend=function(t,e,n,o){var i=this[e];return this.define(t,r.default({},i,n),o)},t}();e.DefineModule=o},function(t,e,n){"use strict";function r(t,e){return Object(o.a)(t)?t:Object(i.a)(t,e)?[t]:Object(a.a)(Object(s.a)(t))}var o=n(3),i=n(46),a=n(50),s=n(75);e.a=r},function(t,e,n){"use strict";function r(t){return"symbol"==typeof t||Object(i.a)(t)&&Object(o.a)(t)==a}var o=n(4),i=n(2),a="[object Symbol]";e.a=r},function(t,e,n){"use strict";var r=n(1),o=r.a.Symbol;e.a=o},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var o=n(53),i=n(70),a=n(72),s=n(73),u=n(74);r.prototype.clear=o.a,r.prototype.delete=i.a,r.prototype.get=a.a,r.prototype.has=s.a,r.prototype.set=u.a,e.a=r},function(t,e,n){"use strict";function r(t){if(!Object(i.a)(t))return!1;var e=Object(o.a)(t);return e==s||e==u||e==a||e==c}var o=n(4),i=n(0),a="[object AsyncFunction]",s="[object Function]",u="[object GeneratorFunction]",c="[object Proxy]";e.a=r},function(t,e,n){"use strict";function r(t){if("string"==typeof t||Object(o.a)(t))return t;var e=t+"";return"0"==e&&1/t==-i?"-0":e}var o=n(14),i=1/0;e.a=r},function(t,e,n){"use strict";function r(t,e,n){"__proto__"==e&&o.a?Object(o.a)(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var o=n(27);e.a=r},function(t,e,n){"use strict";function r(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||i.test(t))&&t>-1&&t%1==0&&t<e}var o=9007199254740991,i=/^(?:0|[1-9]\d*)$/;e.a=r},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";function r(t){return null!=t&&Object(i.a)(t.length)&&!Object(o.a)(t)}var o=n(17),i=n(33);e.a=r},function(t,e,n){"use strict";function r(t,e){e=Object(o.a)(e,t);for(var n=0,r=e.length;null!=t&&n<r;)t=t[Object(i.a)(e[n++])];return n&&n==r?t:void 0}var o=n(13),i=n(18);e.a=r},function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(e,n(47))},function(t,e,n){"use strict";var r=n(6),o=n(1),i=Object(r.a)(o.a,"Map");e.a=i},function(t,e,n){"use strict";function r(t,e,n){var r=t[e];s.call(t,e)&&Object(i.a)(r,n)&&(void 0!==n||e in t)||Object(o.a)(t,e,n)}var o=n(19),i=n(9),a=Object.prototype,s=a.hasOwnProperty;e.a=r},function(t,e,n){"use strict";var r=n(6),o=function(){try{var t=Object(r.a)(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();e.a=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(85),o=n(116),i=Object(o.a)(function(t,e,n){Object(r.a)(t,e,n)});e.default=i},function(t,e,n){"use strict";function r(t,e,n){(void 0===n||Object(i.a)(t[e],n))&&(void 0!==n||e in t)||Object(o.a)(t,e,n)}var o=n(19),i=n(9);e.a=r},function(t,e,n){"use strict";var r=n(102),o=Object(r.a)(Object.getPrototypeOf,Object);e.a=o},function(t,e,n){"use strict";function r(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||o)}var o=Object.prototype;e.a=r},function(t,e,n){"use strict";var r=n(103),o=n(2),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,u=Object(r.a)(function(){return arguments}())?r.a:function(t){return Object(o.a)(t)&&a.call(t,"callee")&&!s.call(t,"callee")};e.a=u},function(t,e,n){"use strict";function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}var o=9007199254740991;e.a=r},function(t,e,n){"use strict";(function(t){var r=n(1),o=n(105),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i,u=s?r.a.Buffer:void 0,c=u?u.isBuffer:void 0,f=c||o.a;e.a=f}).call(e,n(21)(t))},function(t,e,n){"use strict";var r=n(107),o=n(108),i=n(109),a=i.a&&i.a.isTypedArray,s=a?Object(o.a)(a):r.a;e.a=s},function(t,e,n){"use strict";function r(t){return Object(a.a)(t)?Object(o.a)(t,!0):Object(i.a)(t)}var o=n(112),i=n(114),a=n(22);e.a=r},function(t,e,n){"use strict";function r(t){return t}e.a=r},function(t,e,n){"use strict";function r(t,e){return t.replace(/{(.*?)}/g,function(t,n){for(var r=e,o=0,i=n.split(".");o<i.length;o++){r=r[i[o]]}return r||""})}function o(t,e){return(t||"").length*e}function i(t,e){var n=String(e).toLowerCase();return String(t).toLowerCase()===n}function a(t,e){var n=s(e);return t.filter(function(t){return n.some(function(e){return i(e,t.value)})||n.some(function(e){return i(e,t.label)})||n.some(function(e){return(t.synonyms||[]).some(function(t){return i(e,t)})})})[0]}function s(t){return t instanceof Array?t:[t]}function u(t,e){return e.filter(function(e){return t.toLowerCase().indexOf(e.toLowerCase())>=0})}Object.defineProperty(e,"__esModule",{value:!0}),e.compileTemplate=r,e.calculateDelayToTypeMessage=o,e.isMatchAnswer=i,e.findOptionByAnswer=a,e.ensureArray=s,e.identifyAnswersInString=u},function(t,e,n){"use strict";function r(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}e.a=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),i=n(11),a={WaitForUserInput:{validators:[{function:function(t,e){throw new i.PauseRuleTypeExecutors(e.name)}}]}},s=function(t){function e(){var e=t.call(this)||this;return e.define(a),e}return r(e,t),e}(o.DefineModule);e.Executors=s},function(t,e,n){"use strict";var r=n(42);t.exports=r.YveBotChat},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(43),o=n(146),i=function(){function t(t,e){var n=this,i={target:"body",inputPlaceholder:"Type your message",inputPlaceholderSingleChoice:"Choose an option above",inputPlaceholderMutipleChoice:"Choose the options above",doneMultipleChoiceLabel:"Done",andSeparatorText:"and",submitLabel:"Send",timestampable:!1,timestampFormatter:function(t){return new Date(t).toUTCString().slice(-12,-4)},autoFocus:!0};this.handlers={},this.options=Object.assign({},i,e),this.bot=new r.YveBot(t,this.options.yveBotOptions),this.UI=new o.ChatUI(this.options),this.bot.on("start",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(document.querySelector(n.options.target).appendChild(n.UI.chat),n.options.autoFocus){n.UI.input.focus()}n.dispatch.apply(n,["start"].concat(t))}).on("talk",function(t,e){n.newMessage("BOT",t,e)}).on("typing",function(){return n.typing()}).on("typed",function(){return n.typed()}).on("storeChanged",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.dispatch.apply(n,["storeChanged"].concat(t))}).on("end",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.dispatch.apply(n,["end"].concat(t))}),this.UI.form.addEventListener("submit",function(t){t.preventDefault();var e=n.UI.input,r=e.value.trim();r&&(n.dispatch("reply",r),n.bot.hear(r),n.newMessage("USER",r),e.value=""),n.options.autoFocus&&e.focus()})}return t.prototype.start=function(){return this.bot.start(),this},t.prototype.on=function(t,e){return t in this.handlers?this.handlers[t].push(e):this.handlers[t]=[e],this},t.prototype.dispatch=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t in this.handlers&&this.handlers[t].forEach(function(t){return t.apply(void 0,e)}),this},t.prototype.typing=function(){return this.UI.typing.classList.add("is-typing"),this.UI.scrollDown(),this},t.prototype.typed=function(){return this.UI.typing.classList.remove("is-typing"),this.UI.scrollDown(),this},t.prototype.newMessage=function(t,e,n){var r=this,o=this.UI,i="BOT"===t?this.options.name:null,a=o.createThread(t,o.createTextMessage(e,i));if("BOT"===t)switch(n.type){case"SingleChoice":a.appendChild(o.createSingleChoiceMessage(n,function(t,e){r.bot.hear(e),r.dispatch("reply",e),r.newMessage("USER",t)}));break;case"MultipleChoice":a.appendChild(o.createMultipleChoiceMessage(n,function(t,e){r.bot.hear(e),r.dispatch("reply",e),r.newMessage("USER",t)}))}return o.appendThread(this.UI.conversation,a),this},t}();e.YveBotChat=i},function(t,e,n){"use strict";function r(t){return"string"==typeof t?{message:t}:(["SingleChoice","MultipleChoice"].indexOf(t.type)>=0&&(t.options=(t.options||[]).map(function(t){if("string"==typeof t)return{value:t};if("string"==typeof t.synonyms&&t.synonyms){var e=t.synonyms;t.synonyms=e.split(",").map(function(t){return t.trim()})}return t})),t)}function o(t){var e=[];return t.forEach(function(t){if("string"!=typeof t&&"rules"in t&&"flow"in t){var n=t;e=e.concat(n.rules.map(function(e){return Object.assign({},r(e),{flow:t.flow})}))}else e.push(r(t))}),e}Object.defineProperty(e,"__esModule",{value:!0});var i=n(44),a=n(125),s=n(126),u=n(127),c=n(40),f=n(145),l=n(11),p=function(){function t(t,e){var n={enableWaitForSleep:!0,timePerChar:40};this.sessionId="session",this.options=Object.assign({},n,e),this.rules=o(t),this.handlers={},this.store=new i.Store(this),this.controller=new a.Controller(this),this.options.context&&this.store.set("context",this.options.context),this.on("error",function(t){throw t})}return Object.defineProperty(t.prototype,"context",{get:function(){return this.store.get("context")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"types",{get:function(){return t.types},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actions",{get:function(){return t.actions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"executors",{get:function(){return t.executors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validators",{get:function(){return t.validators},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e){return!(["error"].indexOf(t)>=0)&&t in this.handlers?this.handlers[t].push(e):this.handlers[t]=[e],this},t.prototype.start=function(){return this.dispatch("start"),this.controller.run().catch(this.tryCatch.bind(this)),this},t.prototype.end=function(){return this.dispatch("end",this.store.output()),this},t.prototype.talk=function(t,e){var n=Object.assign({},this.options.rule,e||{});return this.controller.sendMessage(t,n),this},t.prototype.hear=function(t){return this.controller.receiveMessage(t).catch(this.tryCatch.bind(this)),this},t.prototype.dispatch=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t in this.handlers&&this.handlers[t].forEach(function(t){return t.apply(void 0,n.concat([e.sessionId]))})},t.prototype.session=function(t,e){return void 0===e&&(e={}),this.sessionId=t,e.rules?(this._rules=this.rules,this.rules=e.rules.map(function(t){return r(t)})):this.rules=this._rules||this.rules,e.store?this.store.replace(e.store):(this.store.reset(),this.controller.reindex()),e.context&&this.store.set("context",e.context),this},t.prototype.tryCatch=function(t){this.dispatch("error",t),this.end()},t}();e.YveBot=p,p.types=new u.Types,p.actions=new s.Actions,p.executors=new c.Executors,p.validators=new f.Validators,p.exceptions=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(45),o=n(78),i=n(80),a=n(28),s=function(){function t(t){this.bot=t,this.reset()}return t.prototype.output=function(){var t=this.get("output");return Object.assign({},t)},t.prototype.set=function(t,e){this.data=o.default(this.data,t,e),this.bot.dispatch("storeChanged",this.data)},t.prototype.get=function(t){return t?r.default(this.data,t):this.data},t.prototype.unset=function(t){var e=this.data;i.default(e,t),this.data=e,this.bot.dispatch("storeChanged",this.data)},t.prototype.reset=function(){this.data={currentIdx:0,waitingForAnswer:!1,output:{}}},t.prototype.replace=function(t){this.reset(),this.data=a.default({},this.data,t)},t}();e.Store=s},function(t,e,n){"use strict";function r(t,e,n){var r=null==t?void 0:Object(o.a)(t,e);return void 0===r?n:r}Object.defineProperty(e,"__esModule",{value:!0});var o=n(23);e.default=r},function(t,e,n){"use strict";function r(t,e){if(Object(o.a)(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Object(i.a)(t))||(s.test(t)||!a.test(t)||null!=e&&t in Object(e))}var o=n(3),i=n(14),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.a=r},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function r(t){var e=a.call(t,u),n=t[u];try{t[u]=void 0;var r=!0}catch(t){}var o=s.call(t);return r&&(e?t[u]=n:delete t[u]),o}var o=n(15),i=Object.prototype,a=i.hasOwnProperty,s=i.toString,u=o.a?o.a.toStringTag:void 0;e.a=r},function(t,e,n){"use strict";function r(t){return i.call(t)}var o=Object.prototype,i=o.toString;e.a=r},function(t,e,n){"use strict";var r=n(51),o=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,s=Object(r.a)(function(t){var e=[];return o.test(t)&&e.push(""),t.replace(i,function(t,n,r,o){e.push(r?o.replace(a,"$1"):n||t)}),e});e.a=s},function(t,e,n){"use strict";function r(t){var e=Object(o.a)(t,function(t){return n.size===i&&n.clear(),t}),n=e.cache;return e}var o=n(52),i=500;e.a=r},function(t,e,n){"use strict";function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(r.Cache||o.a),n}var o=n(16),i="Expected a function";r.Cache=o.a,e.a=r},function(t,e,n){"use strict";function r(){this.size=0,this.__data__={hash:new o.a,map:new(a.a||i.a),string:new o.a}}var o=n(54),i=n(7),a=n(25);e.a=r},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}var o=n(55),i=n(61),a=n(62),s=n(63),u=n(64);r.prototype.clear=o.a,r.prototype.delete=i.a,r.prototype.get=a.a,r.prototype.has=s.a,r.prototype.set=u.a,e.a=r},function(t,e,n){"use strict";function r(){this.__data__=o.a?Object(o.a)(null):{},this.size=0}var o=n(5);e.a=r},function(t,e,n){"use strict";function r(t){return!(!Object(a.a)(t)||Object(i.a)(t))&&(Object(o.a)(t)?d:c).test(Object(s.a)(t))}var o=n(17),i=n(57),a=n(0),s=n(59),u=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,f=Function.prototype,l=Object.prototype,p=f.toString,h=l.hasOwnProperty,d=RegExp("^"+p.call(h).replace(u,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.a=r},function(t,e,n){"use strict";function r(t){return!!i&&i in t}var o=n(58),i=function(){var t=/[^.]+$/.exec(o.a&&o.a.keys&&o.a.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();e.a=r},function(t,e,n){"use strict";var r=n(1),o=r.a["__core-js_shared__"];e.a=o},function(t,e,n){"use strict";function r(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var o=Function.prototype,i=o.toString;e.a=r},function(t,e,n){"use strict";function r(t,e){return null==t?void 0:t[e]}e.a=r},function(t,e,n){"use strict";function r(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}e.a=r},function(t,e,n){"use strict";function r(t){var e=this.__data__;if(o.a){var n=e[t];return n===i?void 0:n}return s.call(e,t)?e[t]:void 0}var o=n(5),i="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;e.a=r},function(t,e,n){"use strict";function r(t){var e=this.__data__;return o.a?void 0!==e[t]:a.call(e,t)}var o=n(5),i=Object.prototype,a=i.hasOwnProperty;e.a=r},function(t,e,n){"use strict";function r(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=o.a&&void 0===e?i:e,this}var o=n(5),i="__lodash_hash_undefined__";e.a=r},function(t,e,n){"use strict";function r(){this.__data__=[],this.size=0}e.a=r},function(t,e,n){"use strict";function r(t){var e=this.__data__,n=Object(o.a)(e,t);return!(n<0)&&(n==e.length-1?e.pop():a.call(e,n,1),--this.size,!0)}var o=n(8),i=Array.prototype,a=i.splice;e.a=r},function(t,e,n){"use strict";function r(t){var e=this.__data__,n=Object(o.a)(e,t);return n<0?void 0:e[n][1]}var o=n(8);e.a=r},function(t,e,n){"use strict";function r(t){return Object(o.a)(this.__data__,t)>-1}var o=n(8);e.a=r},function(t,e,n){"use strict";function r(t,e){var n=this.__data__,r=Object(o.a)(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var o=n(8);e.a=r},function(t,e,n){"use strict";function r(t){var e=Object(o.a)(this,t).delete(t);return this.size-=e?1:0,e}var o=n(10);e.a=r},function(t,e,n){"use strict";function r(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}e.a=r},function(t,e,n){"use strict";function r(t){return Object(o.a)(this,t).get(t)}var o=n(10);e.a=r},function(t,e,n){"use strict";function r(t){return Object(o.a)(this,t).has(t)}var o=n(10);e.a=r},function(t,e,n){"use strict";function r(t,e){var n=Object(o.a)(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var o=n(10);e.a=r},function(t,e,n){"use strict";function r(t){return null==t?"":Object(o.a)(t)}var o=n(76);e.a=r},function(t,e,n){"use strict";function r(t){if("string"==typeof t)return t;if(Object(a.a)(t))return Object(i.a)(t,r)+"";if(Object(s.a)(t))return f?f.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}var o=n(15),i=n(77),a=n(3),s=n(14),u=1/0,c=o.a?o.a.prototype:void 0,f=c?c.toString:void 0;e.a=r},function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}e.a=r},function(t,e,n){"use strict";function r(t,e,n){return null==t?t:Object(o.a)(t,e,n)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(79);e.default=r},function(t,e,n){"use strict";function r(t,e,n,r){if(!Object(s.a)(t))return t;e=Object(i.a)(e,t);for(var c=-1,f=e.length,l=f-1,p=t;null!=p&&++c<f;){var h=Object(u.a)(e[c]),d=n;if(c!=l){var b=p[h];d=r?r(b,h,p):void 0,void 0===d&&(d=Object(s.a)(b)?b:Object(a.a)(e[c+1])?[]:{})}Object(o.a)(p,h,d),p=p[h]}return t}var o=n(26),i=n(13),a=n(20),s=n(0),u=n(18);e.a=r},function(t,e,n){"use strict";function r(t,e){return null==t||Object(o.a)(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(81);e.default=r},function(t,e,n){"use strict";function r(t,e){return e=Object(o.a)(e,t),null==(t=Object(a.a)(t,e))||delete t[Object(s.a)(Object(i.a)(e))]}var o=n(13),i=n(82),a=n(83),s=n(18);e.a=r},function(t,e,n){"use strict";function r(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}e.a=r},function(t,e,n){"use strict";function r(t,e){return e.length<2?t:Object(o.a)(t,Object(i.a)(e,0,-1))}var o=n(23),i=n(84);e.a=r},function(t,e,n){"use strict";function r(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),n=n>o?o:n,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}e.a=r},function(t,e,n){"use strict";function r(t,e,n,f,l){t!==e&&Object(a.a)(e,function(a,c){if(Object(u.a)(a))l||(l=new o.a),Object(s.a)(t,e,c,n,r,f,l);else{var p=f?f(t[c],a,c+"",t,e,l):void 0;void 0===p&&(p=a),Object(i.a)(t,c,p)}},c.a)}var o=n(86),i=n(29),a=n(92),s=n(94),u=n(0),c=n(36);e.a=r},function(t,e,n){"use strict";function r(t){var e=this.__data__=new o.a(t);this.size=e.size}var o=n(7),i=n(87),a=n(88),s=n(89),u=n(90),c=n(91);r.prototype.clear=i.a,r.prototype.delete=a.a,r.prototype.get=s.a,r.prototype.has=u.a,r.prototype.set=c.a,e.a=r},function(t,e,n){"use strict";function r(){this.__data__=new o.a,this.size=0}var o=n(7);e.a=r},function(t,e,n){"use strict";function r(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}e.a=r},function(t,e,n){"use strict";function r(t){return this.__data__.get(t)}e.a=r},function(t,e,n){"use strict";function r(t){return this.__data__.has(t)}e.a=r},function(t,e,n){"use strict";function r(t,e){var n=this.__data__;if(n instanceof o.a){var r=n.__data__;if(!i.a||r.length<s-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new a.a(r)}return n.set(t,e),this.size=n.size,this}var o=n(7),i=n(25),a=n(16),s=200;e.a=r},function(t,e,n){"use strict";var r=n(93),o=Object(r.a)();e.a=o},function(t,e,n){"use strict";function r(t){return function(e,n,r){for(var o=-1,i=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++o];if(!1===n(i[u],u,i))break}return e}}e.a=r},function(t,e,n){"use strict";function r(t,e,n,r,m,g,j){var O=t[n],_=e[n],w=j.get(_);if(w)return void Object(o.a)(t,n,w);var x=g?g(O,_,n+"",t,e,j):void 0,A=void 0===x;if(A){var E=Object(f.a)(_),P=!E&&Object(p.a)(_),T=!E&&!P&&Object(y.a)(_);x=_,E||P||T?Object(f.a)(O)?x=O:Object(l.a)(O)?x=Object(s.a)(O):P?(A=!1,x=Object(i.a)(_,!0)):T?(A=!1,x=Object(a.a)(_,!0)):x=[]:Object(b.a)(_)||Object(c.a)(_)?(x=O,Object(c.a)(O)?x=Object(v.a)(O):(!Object(d.a)(O)||r&&Object(h.a)(O))&&(x=Object(u.a)(_))):A=!1}A&&(j.set(_,x),m(x,_,r,g,j),j.delete(_)),Object(o.a)(t,n,x)}var o=n(29),i=n(95),a=n(96),s=n(99),u=n(100),c=n(32),f=n(3),l=n(104),p=n(34),h=n(17),d=n(0),b=n(106),y=n(35),v=n(110);e.a=r},function(t,e,n){"use strict";(function(t){function r(t,e){if(e)return t.slice();var n=t.length,r=c?c(n):new t.constructor(n);return t.copy(r),r}var o=n(1),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i,u=s?o.a.Buffer:void 0,c=u?u.allocUnsafe:void 0;e.a=r}).call(e,n(21)(t))},function(t,e,n){"use strict";function r(t,e){var n=e?Object(o.a)(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var o=n(97);e.a=r},function(t,e,n){"use strict";function r(t){var e=new t.constructor(t.byteLength);return new o.a(e).set(new o.a(t)),e}var o=n(98);e.a=r},function(t,e,n){"use strict";var r=n(1),o=r.a.Uint8Array;e.a=o},function(t,e,n){"use strict";function r(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}e.a=r},function(t,e,n){"use strict";function r(t){return"function"!=typeof t.constructor||Object(a.a)(t)?{}:Object(o.a)(Object(i.a)(t))}var o=n(101),i=n(30),a=n(31);e.a=r},function(t,e,n){"use strict";var r=n(0),o=Object.create,i=function(){function t(){}return function(e){if(!Object(r.a)(e))return{};if(o)return o(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();e.a=i},function(t,e,n){"use strict";function r(t,e){return function(n){return t(e(n))}}e.a=r},function(t,e,n){"use strict";function r(t){return Object(i.a)(t)&&Object(o.a)(t)==a}var o=n(4),i=n(2),a="[object Arguments]";e.a=r},function(t,e,n){"use strict";function r(t){return Object(i.a)(t)&&Object(o.a)(t)}var o=n(22),i=n(2);e.a=r},function(t,e,n){"use strict";function r(){return!1}e.a=r},function(t,e,n){"use strict";function r(t){if(!Object(a.a)(t)||Object(o.a)(t)!=s)return!1;var e=Object(i.a)(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&f.call(n)==p}var o=n(4),i=n(30),a=n(2),s="[object Object]",u=Function.prototype,c=Object.prototype,f=u.toString,l=c.hasOwnProperty,p=f.call(Object);e.a=r},function(t,e,n){"use strict";function r(t){return Object(a.a)(t)&&Object(i.a)(t.length)&&!!s[Object(o.a)(t)]}var o=n(4),i=n(33),a=n(2),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.a=r},function(t,e,n){"use strict";function r(t){return function(e){return t(e)}}e.a=r},function(t,e,n){"use strict";(function(t){var r=n(24),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o,s=a&&r.a.process,u=function(){try{return s&&s.binding&&s.binding("util")}catch(t){}}();e.a=u}).call(e,n(21)(t))},function(t,e,n){"use strict";function r(t){return Object(o.a)(t,Object(i.a)(t))}var o=n(111),i=n(36);e.a=r},function(t,e,n){"use strict";function r(t,e,n,r){var a=!n;n||(n={});for(var s=-1,u=e.length;++s<u;){var c=e[s],f=r?r(n[c],t[c],c,n,t):void 0;void 0===f&&(f=t[c]),a?Object(i.a)(n,c,f):Object(o.a)(n,c,f)}return n}var o=n(26),i=n(19);e.a=r},function(t,e,n){"use strict";function r(t,e){var n=Object(a.a)(t),r=!n&&Object(i.a)(t),f=!n&&!r&&Object(s.a)(t),p=!n&&!r&&!f&&Object(c.a)(t),h=n||r||f||p,d=h?Object(o.a)(t.length,String):[],b=d.length;for(var y in t)!e&&!l.call(t,y)||h&&("length"==y||f&&("offset"==y||"parent"==y)||p&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||Object(u.a)(y,b))||d.push(y);return d}var o=n(113),i=n(32),a=n(3),s=n(34),u=n(20),c=n(35),f=Object.prototype,l=f.hasOwnProperty;e.a=r},function(t,e,n){"use strict";function r(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}e.a=r},function(t,e,n){"use strict";function r(t){if(!Object(o.a)(t))return Object(a.a)(t);var e=Object(i.a)(t),n=[];for(var r in t)("constructor"!=r||!e&&u.call(t,r))&&n.push(r);return n}var o=n(0),i=n(31),a=n(115),s=Object.prototype,u=s.hasOwnProperty;e.a=r},function(t,e,n){"use strict";function r(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}e.a=r},function(t,e,n){"use strict";function r(t){return Object(o.a)(function(e,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(a=t.length>3&&"function"==typeof a?(o--,a):void 0,s&&Object(i.a)(n[0],n[1],s)&&(a=o<3?void 0:a,o=1),e=Object(e);++r<o;){var u=n[r];u&&t(e,u,r,a)}return e})}var o=n(117),i=n(124);e.a=r},function(t,e,n){"use strict";function r(t,e){return Object(a.a)(Object(i.a)(t,e,o.a),t+"")}var o=n(37),i=n(118),a=n(120);e.a=r},function(t,e,n){"use strict";function r(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var r=arguments,a=-1,s=i(r.length-e,0),u=Array(s);++a<s;)u[a]=r[e+a];a=-1;for(var c=Array(e+1);++a<e;)c[a]=r[a];return c[e]=n(u),Object(o.a)(t,this,c)}}var o=n(119),i=Math.max;e.a=r},function(t,e,n){"use strict";function r(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}e.a=r},function(t,e,n){"use strict";var r=n(121),o=n(123),i=Object(o.a)(r.a);e.a=i},function(t,e,n){"use strict";var r=n(122),o=n(27),i=n(37),a=o.a?function(t,e){return Object(o.a)(t,"toString",{configurable:!0,enumerable:!1,value:Object(r.a)(e),writable:!0})}:i.a;e.a=a},function(t,e,n){"use strict";function r(t){return function(){return t}}e.a=r},function(t,e,n){"use strict";function r(t){var e=0,n=0;return function(){var r=a(),s=i-(r-n);if(n=r,s>0){if(++e>=o)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var o=800,i=16,a=Date.now;e.a=r},function(t,e,n){"use strict";function r(t,e,n){if(!Object(s.a)(n))return!1;var r=typeof e;return!!("number"==r?Object(i.a)(n)&&Object(a.a)(e,n.length):"string"==r&&e in n)&&Object(o.a)(n[e],t)}var o=n(9),i=n(22),a=n(20),s=n(0);e.a=r},function(t,e,n){"use strict";function r(t,e,n,r){return u(this,void 0,void 0,function(){var o,i,a,s,u;return c(this,function(c){return o=e.validators||[],i=n.types[e.type].executors||[{}],a=i[r]||{},s=[].concat(0===r?o:[],a.validators||[]),u=l.ensureArray(t),s.forEach(function(t){Object.keys(t).forEach(function(r){var o=n.validators[r];if(o&&"warning"!==r){var i=t[r];if(!u.every(function(t){return o.validate(i,t,e,n)})){var a=t.warning||o.warning,s="function"==typeof a?a(i):a;throw new f.ValidatorError(s,e)}}})}),[2,t]})})}function o(t,e){var n=t.store.output(),r=t.controller.indexes,o=/(?!\{)\w+[.]((?:\w+[.])*\w+)(?=\})/g,i=(e.match(o)||[]).map(function(t){return t.split(".")[0]});return Array.from(new Set(i)).map(function(e){var o=t.rules[r[e]];if(o&&o.options){var i=n[e];n[e]=function(){if(i instanceof Array)return i.map(function(t){var e=l.findOptionByAnswer(o.options,t);return e.toString=function(){return t},e});var t=l.findOptionByAnswer(o.options,i);return t.toString=function(){return i},t}()}}),l.compileTemplate(e,n).trim()}function i(t,e,n){var r=this,o=e[n]||[];return Promise.all(o.map(function(n){return u(r,void 0,void 0,function(){var r=this;return c(this,function(o){return[2,Promise.all(Object.keys(n).map(function(o){return u(r,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:return o in t.actions?[4,t.actions[o](n[o],e,t)]:[3,2];case 1:return[2,r.sent()];case 2:return[2,null]}})})}))]})})}))}function a(t,e){if(t.options&&e){var n=l.findOptionByAnswer(t.options,e);if(n&&n.next)return n.next}return t.next?t.next:null}function s(t,e){var n=t.rules[e]?t.rules[e]:{exit:!0};return Object.assign({},t.options.rule,n)}var u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(e,"__esModule",{value:!0});var f=n(11),l=n(38),p=function(){function t(t){this.bot=t,this._indexes={},this.reindex()}return t.prototype.reindex=function(){var t=this;this.bot.rules.forEach(function(e,n){var r=e.name,o=e.flow;if(r){var i=o?[o,r].join("."):r;t._indexes[i]=n}})},Object.defineProperty(t.prototype,"indexes",{get:function(){return this._indexes},enumerable:!0,configurable:!0}),t.prototype.run=function(t){return void 0===t&&(t=0),u(this,void 0,void 0,function(){var e,n;return c(this,function(r){switch(r.label){case 0:return e=this.bot,n=s(e,t),e.store.set("currentIdx",t),e.options.enableWaitForSleep&&"sleep"in n?[4,e.actions.timeout(n.sleep)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,i(e,n,"preActions")];case 3:return r.sent(),n.message?[4,this.sendMessage(n.message,n)]:[3,5];case 4:r.sent(),r.label=5;case 5:return[4,i(e,n,"actions")];case 6:if(r.sent(),n.exit)return e.end(),[2,this];if(!n.type)return[2,this.nextRule(n)];if(!e.types[n.type])throw new f.InvalidAttributeError("type",n);return e.store.set("waitingForAnswer",!0),e.dispatch("hear"),[2,this]}})})},t.prototype.sendMessage=function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return c(this,function(a){switch(a.label){case 0:return n=this.bot,n.dispatch("typing"),!n.options.enableWaitForSleep||e.exit?[3,4]:"delay"in e?[4,n.actions.timeout(e.delay)]:[3,2];case 1:return a.sent(),[3,4];case 2:return r=n.options.timePerChar,[4,n.actions.timeout(l.calculateDelayToTypeMessage(t,r))];case 3:a.sent(),a.label=4;case 4:return i=o(n,t),n.dispatch("talk",i,e),n.dispatch("typed"),[2,this]}})})},t.prototype.getRuleExecutorIndex=function(t){return this.bot.store.get("executors."+t.name+".currentIdx")||0},t.prototype.incRuleExecutorIndex=function(t){this.bot.store.set("executors."+t.name+".currentIdx",this.getRuleExecutorIndex(t)+1)},t.prototype.resetRuleExecutorIndex=function(t){this.bot.store.unset("executors."+t.name+".currentIdx")},t.prototype.executeRuleTypeExecutors=function(t,e){return u(this,void 0,void 0,function(){var n,o,i,a,s,u,f,l,p=this;return c(this,function(c){switch(c.label){case 0:return n=this.bot,o=this.getRuleExecutorIndex(t),i=n.types[t.type].executors,a=i.slice(o)[0]||{},s=a.transform,u=void 0===s?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Promise.resolve(t[0])}:s,[4,u(e,t,n).then(function(e){return r(e,t,n,p.getRuleExecutorIndex(t))})];case 1:return f=c.sent(),(l=this.getRuleExecutorIndex(t)===i.length-1)?[3,3]:(this.incRuleExecutorIndex(t),[4,this.executeRuleTypeExecutors(t,f)]);case 2:return[2,c.sent()];case 3:return this.resetRuleExecutorIndex(t),[2,f]}})})},t.prototype.receiveMessage=function(t){return u(this,void 0,void 0,function(){var e,n,r,o,a,u,l,p;return c(this,function(c){switch(c.label){case 0:if(e=this.bot,n=e.store.get("currentIdx"),r=s(e,n),!e.store.get("waitingForAnswer"))return[2,this];c.label=1;case 1:return c.trys.push([1,3,,6]),[4,this.executeRuleTypeExecutors(r,t)];case 2:return o=c.sent(),[3,6];case 3:return a=c.sent(),(u=!1,a instanceof f.ValidatorError)?(u=!0,[4,this.sendMessage(a.message,r)]):[3,5];case 4:c.sent(),c.label=5;case 5:if(a instanceof f.PauseRuleTypeExecutors&&(u=!0,this.incRuleExecutorIndex(r)),u)return e.dispatch("hear"),[2,this];throw a;case 6:return e.store.set("waitingForAnswer",!1),(l=r.output||r.name,l&&e.store.set("output."+l,o),r.replyMessage)?(p=Object.assign({},e.options.rule),[4,this.sendMessage(r.replyMessage,p)]):[3,8];case 7:c.sent(),c.label=8;case 8:return[4,i(e,r,"postActions")];case 9:return c.sent(),[2,this.nextRule(r,o)]}})})},t.prototype.jumpByName=function(t){var e=this._indexes[t];if("number"!=typeof e)throw new f.RuleNotFound(t,this._indexes);return this.run(e)},t.prototype.nextRule=function(t,e){var n=this.bot,r=a(t,e);if(r){var o=r.indexOf(".")>0,i=o?r:[t.flow,r].filter(function(t){return!!t}).join(".");this.jumpByName(i)}else{var s=n.store.get("currentIdx")+1;this.run(s)}return this},t}();e.Controller=p},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),i={timeout:function(t){return new Promise(function(e){return setTimeout(e,t)})}},a=function(t){function e(){var e=t.call(this)||this;return e.define(i),e}return r(e,t),e}(o.DefineModule);e.Actions=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},a=this;Object.defineProperty(e,"__esModule",{value:!0}),n(128);var s=n(130),u=n(12),c=n(11),f=n(40),l=n(38),p=new f.Executors,h={Any:{executors:[{}]},String:{executors:[{transform:function(t){return o(a,void 0,void 0,function(){return i(this,function(e){return[2,String(t)]})})},validators:[{string:!0,warning:"Invalid string"}]}]},Number:{executors:[{transform:function(t){return o(a,void 0,void 0,function(){return i(this,function(e){return[2,Number(t)]})})},validators:[{number:!0,warning:"Invalid number"}]}]},SingleChoice:{executors:[{transform:function(t,e){return o(a,void 0,void 0,function(){var n;return i(this,function(r){return n=l.findOptionByAnswer(e.options,t),n?[2,n.value||n.label]:[2,void 0]})})},validators:[{function:function(t,e){return!!l.findOptionByAnswer(e.options,t)},warning:"Unknown option"}]}]},MultipleChoice:{executors:[{transform:function(t,e){return o(a,void 0,void 0,function(){var n,r;return i(this,function(o){return t instanceof Array?n=t:(r=[],e.options.forEach(function(t){r.push(String(t.value||t.label)),t.synonyms&&(r=r.concat(t.synonyms))}),n=l.identifyAnswersInString(String(t),r)),[2,s.default(n.map(function(t){var n=l.findOptionByAnswer(e.options,t);if(n)return n.value||n.label}).filter(function(t){return t}))]})})},validators:[{function:function(t,e){var n=l.ensureArray(t),r=e.options.map(function(t){return String(t.value||t.label)});return n.every(function(t){return r.some(function(e){return l.isMatchAnswer(t,e)})})},warning:"Unknown options"}]}]},StringSearch:{executors:[{},{transform:function(t,e,n){return o(a,void 0,void 0,function(){var r,o,a,s,u;return i(this,function(i){return r=e.config,o=r.apiURI,a=r.apiQueryParam,s=r.translate,u=o+"?"+a+"="+encodeURIComponent(String(t)),n.dispatch("typing"),[2,fetch(u).then(function(t){return t.json()}).then(function(t){if(!s)return t;var e=s.label,n=s.value;return t.map(function(t){return{label:t[e],value:t[n]}})})]})})},validators:[{function:function(t,e){if(0===t.length)throw new c.ValidatorError(e.config.messages.noResults,e);return!0}}]},{transform:function(t,e,n){return o(a,void 0,void 0,function(){var r,o,a;return i(this,function(i){return r=e.config.messages,1===t.length?(a=r.didYouMean+": "+t[0].label+"?",o=[{label:r.yes,value:t[0].value},{label:r.no,value:null}]):(a=r.multipleResults+":",o=t.concat([{label:r.noneOfAbove,value:null}])),n.talk(a,{type:"SingleChoice",options:o}),[2]})})},validators:p.WaitForUserInput.validators.slice()},{validators:[{function:function(t,e,n){var r=e.config.messages;return!!t||(n.store.unset("executors."+e.name+".currentIdx"),n.talk(r.wrongResult),p.WaitForUserInput.validators.reduce(function(t,e){return t.concat(Object.keys(e).map(function(t){return e[t]}))},[]).filter(function(t){return t instanceof Function}).every(function(t){return t("",e)}))}}]}]}},d=function(t){function e(){var e=t.call(this)||this;return e.define(h),e}return r(e,t),e}(u.DefineModule);e.Types=d},function(t,e,n){n(129),t.exports=self.fetch.bind(self)},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v.iterable&&(e[Symbol.iterator]=function(){return e}),e}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader,n=a(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=a(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(v.arrayBuffer&&v.blob&&g(t))this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!j(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(t){var e=t.toUpperCase();return O.indexOf(e)>-1?e:t}function h(t,e){e=e||{};var n=e.body;if(t instanceof h){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new o(e.headers)),this.method=p(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function b(t){var e=new o;return t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e}function y(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(v.arrayBuffer)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=function(t){return t&&DataView.prototype.isPrototypeOf(t)},j=ArrayBuffer.isView||function(t){return t&&m.indexOf(Object.prototype.toString.call(t))>-1};o.prototype.append=function(t,r){t=e(t),r=n(r);var o=this.map[t];this.map[t]=o?o+","+r:r},o.prototype.delete=function(t){delete this.map[e(t)]},o.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,r){this.map[e(t)]=n(r)},o.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},o.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},o.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},o.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},v.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var O=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.clone=function(){return new h(this,{body:this._bodyInit})},l.call(h.prototype),l.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var _=[301,302,303,307,308];y.redirect=function(t,e){if(-1===_.indexOf(e))throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=h,t.Response=y,t.fetch=function(t,e){return new Promise(function(n,r){var o=new h(t,e),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:b(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;n(new y(e,t))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&v.blob&&(i.responseType="blob"),o.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send(void 0===o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,e,n){"use strict";function r(t){return t&&t.length?Object(o.a)(t):[]}Object.defineProperty(e,"__esModule",{value:!0});var o=n(131);e.default=r},function(t,e,n){"use strict";function r(t,e,n){var r=-1,l=i.a,p=t.length,h=!0,d=[],b=d;if(n)h=!1,l=a.a;else if(p>=f){var y=e?null:Object(u.a)(t);if(y)return Object(c.a)(y);h=!1,l=s.a,b=new o.a}else b=e?[]:d;t:for(;++r<p;){var v=t[r],m=e?e(v):v;if(v=n||0!==v?v:0,h&&m===m){for(var g=b.length;g--;)if(b[g]===m)continue t;e&&b.push(m),d.push(v)}else l(b,m,n)||(b!==d&&b.push(m),d.push(v))}return d}var o=n(132),i=n(135),a=n(140),s=n(141),u=n(142),c=n(39),f=200;e.a=r},function(t,e,n){"use strict";function r(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new o.a;++e<n;)this.add(t[e])}var o=n(16),i=n(133),a=n(134);r.prototype.add=r.prototype.push=i.a,r.prototype.has=a.a,e.a=r},function(t,e,n){"use strict";function r(t){return this.__data__.set(t,o),this}var o="__lodash_hash_undefined__";e.a=r},function(t,e,n){"use strict";function r(t){return this.__data__.has(t)}e.a=r},function(t,e,n){"use strict";function r(t,e){return!!(null==t?0:t.length)&&Object(o.a)(t,e,0)>-1}var o=n(136);e.a=r},function(t,e,n){"use strict";function r(t,e,n){return e===e?Object(a.a)(t,e,n):Object(o.a)(t,i.a,n)}var o=n(137),i=n(138),a=n(139);e.a=r},function(t,e,n){"use strict";function r(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}e.a=r},function(t,e,n){"use strict";function r(t){return t!==t}e.a=r},function(t,e,n){"use strict";function r(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}e.a=r},function(t,e,n){"use strict";function r(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}e.a=r},function(t,e,n){"use strict";function r(t,e){return t.has(e)}e.a=r},function(t,e,n){"use strict";var r=n(143),o=n(144),i=n(39),a=r.a&&1/Object(i.a)(new r.a([,-0]))[1]==1/0?function(t){return new r.a(t)}:o.a;e.a=a},function(t,e,n){"use strict";var r=n(6),o=n(1),i=Object(r.a)(o.a,"Set");e.a=i},function(t,e,n){"use strict";function r(){}e.a=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),i=function(t){return/^\d+$/.test(t)},a=function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},s=function(t){return i(t)?Number(t):t.length},u={required:{validate:function(t,e){return Boolean((e||"").trim())===t},warning:"This is required"},email:{validate:function(t,e){return a(e)===t},warning:"Invalid email format"},regex:{validate:function(t,e){return new RegExp(t).test(e)},warning:"Invalid answer format"},minWords:{validate:function(t,e){return e.split(" ").length>=t},warning:function(t){return"This answer must have at least "+t+" words"}},maxWords:{validate:function(t,e){return e.split(" ").length<=t},warning:function(t){return"This answer must have a maximum "+t+" words"}},min:{validate:function(t,e){return s(e)>=t},warning:function(t){return"This answer length must be min "+t}},max:{validate:function(t,e){return s(e)<=t},warning:function(t){return"This answer length must be max "+t}},lenght:{validate:function(t,e){return s(e)===t},warning:function(t){return"It must have lenght "+t}},string:{validate:function(t,e){return Boolean(!i(e)&&"string"==typeof e)===t},warning:"It must be a string"},number:{validate:function(t,e){return i(e)===t},warning:"It must be a number"},function:{validate:function(t,e,n,r){return t(e,n,r)},warning:"Error on execute a validator function"}},c=function(t){function e(){var e=t.call(this)||this;return e.define(u),e}return r(e,t),e}(o.DefineModule);e.Validators=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(147),o=function(){function t(t){this.options=t,this.chat=this.createChat(),this.typing=this.createTyping(),this.conversation=this.createConversation(),this.input=this.createInput(),this.submit=this.createSubmit(),this.form=this.createForm(this.input,this.submit),this.conversation.appendChild(this.typing),this.chat.appendChild(this.conversation),this.chat.appendChild(this.form)}return t.prototype.createSingleChoiceMessage=function(t,e){var n=this;return t.options.length?(this.disableForm(this.options.inputPlaceholderSingleChoice),this.createBubbleMessage(t,function(t,r){r.remove(),n.enableForm(),e(t.getAttribute("data-label"),t.getAttribute("data-value"))})):document.createElement("div")},t.prototype.createBubbleButton=function(t,e){var n=this,r=document.createElement("button");r.className="yvebot-message-bubbleBtn",r.onclick=function(){e(r),n.scrollDown()};var o=t.value,i=t.label;return r.setAttribute("data-value",String((void 0===o?i:o)||"")),r.setAttribute("data-label",String((void 0===i?o:i)||"")),r.textContent=r.getAttribute("data-label"),r},t.prototype.disableForm=function(t){this.submit.disabled=!0,this.input.disabled=!0,this.input.placeholder=t},t.prototype.enableForm=function(){this.submit.disabled=!1,this.input.disabled=!1,this.input.placeholder=this.options.inputPlaceholder,this.options.autoFocus&&this.input.focus()},t.prototype.createBubbleMessage=function(t,e){var n=this,r=document.createElement("div");return r.className="yvebot-message-bubbles",t.options.forEach(function(t){var o=n.createBubbleButton(t,function(t){return e(t,r)});r.appendChild(o)}),r},t.prototype.createMultipleChoiceMessage=function(t,e){var n=document.createElement("div");if(t.options.length){var o=document.createElement("button");o.textContent=this.options.doneMultipleChoiceLabel,o.className="yvebot-message-bubbleDone",o.style.display="none";var i=this;o.onclick=function(){var t=this.previousElementSibling,n=t.querySelectorAll(".yvebot-message-bubbleBtn.selected"),a=r.nodeListToArray(n).map(function(t){return t.getAttribute("data-label")}),s=r.nodeListToArray(n).map(function(t){return t.getAttribute("data-value")});e(a,s),t.remove(),o.remove(),i.enableForm()};var a=this.createBubbleMessage(t,function(t){t.classList.toggle("selected"),a.querySelectorAll(".yvebot-message-bubbleBtn.selected").length?o.style.display="inline-block":o.style.display="none"});this.disableForm(this.options.inputPlaceholderMutipleChoice),n.appendChild(a),n.appendChild(o)}return n},t.prototype.createChat=function(){var t=document.createElement("div");return t.className="yvebot-chat",t},t.prototype.createConversation=function(){var t=document.createElement("ul");return t.className="yvebot-conversation",t},t.prototype.createTyping=function(){var t=document.createElement("div");return t.className="yvebot-typing",[1,2,3].forEach(function(){var e=document.createElement("span");e.className="yvebot-typing-dot",t.appendChild(e)}),this.createThread("BOT",t,"yvebot-thread-typing")},t.prototype.createForm=function(t,e){var n=document.createElement("form");return n.className="yvebot-form",n.appendChild(t),n.appendChild(e),n},t.prototype.createSubmit=function(){var t=document.createElement("button");return t.className="yvebot-form-submit",t.type="submit",t.textContent=this.options.submitLabel,t},t.prototype.createInput=function(){var t=document.createElement("input");return t.className="yvebot-form-input",t.type="text",t.placeholder=this.options.inputPlaceholder,t.autocomplete="off",t},t.prototype.createThread=function(t,e,n){var r=document.createElement("li");return r.className="yvebot-thread yvebot-thread-"+t.toLowerCase(),n&&r.classList.add(n),r.appendChild(e),r},t.prototype.appendThread=function(t,e){t.insertBefore(e,this.typing),this.scrollDown()},t.prototype.scrollDown=function(){this.conversation.scrollTop=this.conversation.scrollHeight},t.prototype.createTextMessage=function(t,e){var n,o=this.options,i=o.timestampable,a=o.timestampFormatter;if(t instanceof Array){var s=t.map(function(t){return String(t)});n=r.arrayToString(s,this.options.andSeparatorText)}else n=String(t);var u=document.createElement("div");if(u.className="yvebot-bubble",e){var c=document.createElement("div");c.className="yvebot-sender",c.innerHTML=e,u.appendChild(c)}var f=document.createElement("div");if(f.className="yvebot-message",f.innerHTML=n,u.appendChild(f),i){var l=document.createElement("div");l.className="yvebot-timestamp",l.innerHTML=a(Date.now()),u.appendChild(l)}return u},t}();e.ChatUI=o},function(t,e,n){"use strict";function r(t,e){var n=t.slice(0,-1).join(", "),r=t.slice(-1);return 1===t.length?t[0]:n+" "+e+" "+r}function o(t){return[].slice.call(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.arrayToString=r,e.nodeListToArray=o}])});